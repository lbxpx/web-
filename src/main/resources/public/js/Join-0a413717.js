/* empty css             *//* empty css                *//* empty css               *//* empty css              */import{_ as e}from"./CommonHeader-3c26eef5.js";import{m as a}from"./marked.esm-d112d5da.js";import{d as l,Q as s,r as t,c as o,b as r,e as u,f as n,h as d,g as i,t as p,F as v,B as c,k as m,w as j,j as b,E as g,m as f,q as h,I as y,_ as k}from"./index-00623a6b.js";import{s as x,u as I}from"./users-f5a9a53f.js";/* empty css               *//* empty css                  */import"./kon-c071413b.js";const _={class:"project-page"},V={class:"content",style:{"margin-top":"20px"}},C={class:"project-title"},U={class:"project-meta"},$={class:"publisher"},w={class:"project-detail"},H=["innerHTML"],N={key:0},q=["src"],L={key:0,class:"status-container"},M={class:"status-text"},T={key:1,class:"buttons"},B={slot:"footer",class:"dialog-footer"},E=k(l({__name:"Join",setup(l){const k=I().userId,E=s().params.id,F=t(!1),J=t(""),P=t(""),Q=t(),R=t(!0),z=async()=>{await((e,a)=>x({url:`/api/joins/${e}/${a}`,method:"get"}))(E,k).then((e=>{var a;1===e.data.code?(Q.value=e.data.data,(null==(a=Q.value)?void 0:a.publisherId)===k&&(R.value=!1)):g(e.data.msg)})).catch((e=>{g.error("请求出错了："+e.message)}))};o((()=>{var e;return(null==(e=Q.value)?void 0:e.description)?a(Q.value.description):"无详细信息"})),r((()=>{z()}));const A=o((()=>{var e;if(!(null==(e=Q.value)?void 0:e.description))return"无详细信息";let a=Q.value.description;return a=a.replace(/(https?:\/\/[^\s]+)/g,(e=>`<a href="${encodeURIComponent(e)}" target="_blank" rel="noopener noreferrer">${e}</a>`)),a})),D=async()=>{var e,a;await(a={senderId:k,reason:J.value,strengths:P.value,projectId:Number(E),receiverId:Number(null==(e=Q.value)?void 0:e.publisherId)},x({url:"/api/joins",method:"post",data:{...a}})).then((e=>{1===e.data.code&&(G(),g.success("申请已提交！"),z())})).catch((e=>{g.error(e)}))},G=()=>{F.value=!1,J.value="",P.value=""};return(a,l)=>{var s,t,o,r,g,k,x,I;const E=e,z=f,K=h,O=y;return u(),n("div",_,[d(E),i("div",V,[i("h1",C,p(null==(s=Q.value)?void 0:s.title),1),i("div",U,[i("span",$,p(null==(t=Q.value)?void 0:t.publisherName),1),i("div",null,[(u(!0),n(v,null,c(null==(o=Q.value)?void 0:o.categories,(e=>(u(),n("span",{key:e.id,class:"categories-tag"},p(e.name),1)))),128))])]),i("div",w,[i("div",{innerHTML:A.value},null,8,H)]),(null==(r=Q.value)?void 0:r.image)?(u(),n("div",N,[i("img",{src:Q.value.image,alt:"Project Image",class:"project-image"},null,8,q)])):m("",!0)]),(null==(g=Q.value)?void 0:g.status)?(u(),n("div",L,[i("p",M,p(null==(k=Q.value)?void 0:k.status),1)])):m("",!0),R.value?(u(),n("div",T,["rejected"==(null==(x=Q.value)?void 0:x.status)?(u(),n("button",{key:0,class:"apply-button",onClick:l[0]||(l[0]=e=>F.value=!0)},"重新申请")):m("",!0),(null==(I=Q.value)?void 0:I.status)?m("",!0):(u(),n("button",{key:1,class:"apply-button",onClick:l[1]||(l[1]=e=>F.value=!0)},"申请加入"))])):m("",!0),d(O,{modelValue:F.value,"onUpdate:modelValue":l[4]||(l[4]=e=>F.value=e),title:"确认加入",onClose:G},{default:j((()=>{var e;return[i("div",null,[i("p",null,"确认加入 "+p(null==(e=Q.value)?void 0:e.title)+" 吗？",1),d(z,{modelValue:J.value,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value=e),placeholder:"请输入加入理由",style:{"margin-bottom":"15px",border:"1px solid #dcdfe6","border-radius":"4px"}},null,8,["modelValue"]),d(z,{modelValue:P.value,"onUpdate:modelValue":l[3]||(l[3]=e=>P.value=e),placeholder:"请输入自身优势",style:{"margin-bottom":"15px",border:"1px solid #dcdfe6","border-radius":"4px"}},null,8,["modelValue"])]),i("span",B,[d(K,{onClick:G},{default:j((()=>[b("取消")])),_:1}),d(K,{type:"primary",onClick:D},{default:j((()=>[b("加入")])),_:1})])]})),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-650715af"]]);export{E as default};
